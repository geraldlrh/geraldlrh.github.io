<!DOCTYPE html>
<html lang="zh-cn">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no">
  <title>input测试</title>
  <meta name="keyword" content="好期贷,好期贷">
  <meta name="description" content="好期贷">
  <meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="0" />
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
<meta http-equiv="pragma" content="no-cache" />
  <!-- <link href="http://m-zl-st.cfcmu.cn/modules/muapp/vendors.css" rel="stylesheet"> -->
  <!-- <link href="http://m-zl-st.cfcmu.cn/modules/muapp/apply/pre_apply.css" rel="stylesheet"> -->
  <style>
  	body, .wrap {
  		height: 100%;
  	}
  	.wrap {
  		height: 600px;
  		overflow: auto;
	    -webkit-overflow-scrolling: touch;
	    box-sizing: border-box;
	    position: relative;
	    z-index: 1;
  	}
  	input {
  		margin: 20px auto;
  		width: 80%;
  		height: 80px!important;
  		line-height: 80px!important;
  		font-size: 32px;
  	}
		button {
			width: 50px;
			height: 50px;
		}
	</style>
	<!-- <script src="https://gw.alipayobjects.com/as/g/h5-lib/alipayjsapi/3.1.1/alipayjsapi.inc.min.js"></script> -->
	<!-- 如该 H5 页面需要同时在非支付宝客户端内使用，为避免该请求404，可参考以下写法 -->
	<!-- 请尽量在 html 头部执行以下脚本 -->
	<script>
	if (navigator.userAgent.indexOf('AliApp') > -1) {
		document.writeln('<script src="https://appx/web-view.min.js"' + '>' + '<' + '/' + 'script>');
	}
	</script>
	<script>
	// my.navigateTo({url: '../get-user-info/get-user-info'});
	// 网页向小程序 postMessage 消息
	my.postMessage({name:"测试web-view"});
	// 接收来自小程序的消息。
	my.onMessage = function(e) {
		console.log(e); // {'sendToWebView': '1'}
	}
	// 判断是否运行在小程序环境里
	my.getEnv(function(res) {
		console.log(res.miniprogram) // true
	});
	</script>
</head>

<body>
	<!-- <h4>选择视频</h4>
	<input type="file" name="pic" id="pic" accept="video/*" />

	<div>capture="camera"</div>
	<input type="file" name="pic2" id="pic2" accept="video/*" capture="camera" />
	
	<div>capture="user"</div>
	<input type="file" name="pic3" id="pic3" accept="video/*" capture="user" /> -->
	<!-- <button id="J_btn" class="btn btn-default">判断权限</button> -->
	<button id="J_btn2" class="btn btn-default">点我回跳</button>
	
	<!-- <h4>选择图片 capture="camera"</h4>
	<input type="file" name="pic4" id="pic4" accept="image/*" capture="camera" />
	<p>前置摄像头 capture="user"</p>
	<input type="file" name="pic4" id="pic4" accept="image/*" capture="user" /> -->

	<script>
		// var btn = document.querySelector('#J_btn');
		// btn.addEventListener('click', function () {
		// 	window.muapp.PagerJumpPlugin.route('muapp://functionalExt/selectedContactInfo', function(res){
		// 		alert(JSON.stringify(res));
		// 		alert(res.userphone === '');
		// 		alert(!res.userphone);
		// 	});
		// });

		// if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
		// 	navigator.mediaDevices.getUserMedia({ audio: true, video: true })
		// 		.then(stream => alert('success1'))
		// 		.catch(err => alert('fail1' + err.toString()));
		// } else {
		// 	navigator.getUserMedia({ audio: true, video: true },
		// 		function (stream) {
		// 			alert('success2')
		// 		},
		// 		function (err) {
		// 			alert('fail2' + err.toString())
		// 		}
		// 	);
		// }


	function getParamFromHash(key) {
		const reg = new RegExp(`(^|&)${key}=([^&]*)(&|$)`);
		const hashPos = window.location.hash.indexOf('?');
		if (window.location.hash.indexOf('#') > -1) {
			if (hashPos === -1) return undefined;
			const r = window.location.hash.substr(hashPos + 1).match(reg);
			if (r) return decodeURIComponent(r[2]);
			return undefined;
		} else {
			const reg = new RegExp('[?&]' + key + '=([^&]+)', 'gmi');
			const url = window.location.href;
			if (reg.test(url)) return RegExp.$1;
			return '';
		}
	};

		document.querySelector('#J_btn2').addEventListener('click', function () {
			var url = decodeURIComponent(getParamFromHash('cb'))
			if (url) {
				if(window.confirm("回调地址为: "+url)) {
					window.location.href = url;
				}
			}	
		});
		
	</script>

</body>

</html>
